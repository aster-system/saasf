<!DOCTYPE html>
<html lang="fr">
    <head>
        <link href="../../styles/base.css" rel="stylesheet" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SAASF - OpenGL en C++</title>

        <!--Connect to google font-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <!--Get the Hammersmith One font, see https://fonts.google.com/specimen/Hammersmith+One for more informations-->
        <link href="https://fonts.googleapis.com/css2?family=Hammersmith+One&display=swap" rel="stylesheet">
        <!--Get the OpenSans font, see https://fonts.google.com/specimen/Open+Sans for more informations-->
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    </head>
    <body class="open-sans-bold">
        <header class="hammersmith-one-regular">
            <a href="../../index.html">
                <img alt="Logo de SAASF" src="../../images/aster_system_logo.png" style="max-height:150px;">
            </a>
        </header>
        <div id="main_div">
            <h1>
                Utiliser OpenGL en C++
            </h1>
            <div>
                Pour l'instant, les seules interactions que nous pouvons avoir avec notre programme C++ sont les fichiers et la console.
                Nous allons ici apprendre à augmenter les possibilités d'interactions avec le programme, grâce à une API très connue : <a href="https://www.khronos.org/opengl/" target="_blank">OpenGL</a>.
                Pour rappel, nous avons déjà fait un cours sur OpenGL, <a href="../../creations/opengl.html">juste ici</a>.
                Pour des raisons de temps, nous allons considérer tout ce qui a été vu sur ce cours comme acquis.
            </div>
            <div class="left_arrow_right_text">
                <div class="left_arrow_right_text_child">
                    <img alt="Contenu" class="arrow left_arrow_right_text_arrow" src="../../images/arrow.png">
                    <h2 class="left_arrow_right_text_title" id="part_A">
                        A. Créez votre fenêtre OpenGL
                    </h2>
                    <div class="left_arrow_right_text left_arrow_right_text_text">
                        <h3>
                            a. Mettre en place votre environnement
                        </h3>
                        <div>
                            <p>
                                Disons le, <u>OpenGL est une librairie assez complexe à utiliser</u>.
                                Pour y accéder, chaque systèmes d'exploitations offrent nativement différents outils pour y accéder.
                                Cependant, pour gagner du temps, <span class="important">nous allons utiliser des librairies C++ qui permettent d'utiliser simplement tout ça</span>.
                                Nous allons utiliser 3 librairies : <a href="https://www.glfw.org/" target="_blank">GLFW</a>, <a href="https://glad.dav1d.de/" target="_blank">Glad</a> et <a href="https://github.com/g-truc/glm" target="_blank">GLM</a>.
                            </p>
                            <p>
                                <span class="important">GLFW va être un moyen simple d'utiliser un contexte OpenGL</span>.
                                En effet, <u>elle est pleine de fonctions très utiles pour travailler avec OpenGL</u>.
                                Elle a l'avantage d'être cross-platforme et en libre accès.
                                Pour installer GLFW, <a href="https://www.glfw.org/download.html" target="_blank">rendez vous sur cette page</a>.
                                Vous pouvez télécharger le code source et le compiler vous même, ou utiliser du code pré-compilé.
                                Pour rappel, nous avons déjà traité de l'utilisation de librairies de ce genre, <a href="../../astersystemelearn/cpp_lessons/cpp_bases.html" target="_blank">dans ce cours là</a>.
                                Vous devrez théoriquement avoir accès a un DLL, deux fichiers librairies, et un ensemble de headers.
                            </p>
                            <p>
                                <span class="important">Glad va avoir pour tâche de rendre notre code OpenGL cross-plateforme</span>.
                                En effet, comme nous l'avons vu, chaque plateforme propose sa propre implémentation d'OpenGL.
                                <u>Glad réuni tous les types possibles, et les rend accessibles selon la plateforme actuelle</u> grâce au système de <a href="../../astersystemelearn/cpp_lessons/cpp_templates.html">template</a>.
                                Pour installer Glad, <a href="https://glad.dav1d.de/" target="_blank">rendez vous sur cette page</a>.
                                Elle vous demandera pas mal de configuration pour le fichier environnement généré.
                                <span class="important">Comme langage, sélectionnez "C/C++"". Comme spécification, sélectionnez "OpenGL". Comem API, sélectionnez "Version 3.3" dans "gl" (Comme sur notre cours d'OpenGL). Comme "Profile", choisissez "Core".</span>
                                Cependant, à l'inverse de GLFW, Glad ne propose pas de fichiers pré-compilés.
                                <u>Le site vous proposera un dossier de headers, ainsi qu'un fichier "glad.c", à ajouter aux fichiers compilés de votre code</u>.
                            </p>
                            <p>
                                Finalement, <span class="important">GLM va nous apporter un ensemble d'outils mathématiques, très importants pour OpenGL</span>.
                                En effet, <u>les mathématiques nécessaires seront très avancés ici</u>.
                                Heuresement, GLM en propose une partie.
                                Pour installer GLM, <a href="https://github.com/g-truc/glm" target="_blank">rendez vous sur cette page</a>.
                                Vous y trouverez l'ensemble du projet GLM.
                                <span class="important">Vous aurez besoin de tous les headers présents dans le dossier "glm"</span>.
                                Dans cette librairie, il n'y a que des headers.
                            </p>
                            <p>
                                Dés que tout cela est installé, vous pouvez créer votre projet pour commencer à travailler avec OpenGL.
                            </p>
                        </div>
                        <h3>
                            b. Créer votre première fenêtre
                        </h3>
                        <div>
                            <p>
                                Pour créer notre première fenêtre avec OpenGL, <span class="important">il va falloir commencer à écrire le code permettant de configurer OpenGL</span>.
                                <u>Nous vous conseillons grandement de bien le structurer, pour pouvoir l'utiliser de manière plus simple</u>.
                                Cependant, si vous avez la flemme (déconseillé), vous pouvez tout mettre directement dans la fonction "main" de votre code.
                                Avant tout, <u>initialisons GLFW, avec quelques simples lignes de code</u>.
                                <div class="code_sample">
                                    // Initialisation de GLFW</br>
                                    glfwInit();</br>
                                    glfwWindowHint(GLFW_CONTEXT_VERSION_MAJOR, 3);</br>
                                    glfwWindowHint(GLFW_CONTEXT_VERSION_MINOR, 3);</br>
                                    glfwWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
                                </div>
                                Ces fonctions sont assez claires : "glfwInit()" initialise GLFW, et "glfwWindowHint()" permet de configurer certaines valeurs de GLFW, grâce à deux paramètres : la configuration à modifier, et sa nouvelle valeur.
                                Dans ce cas, nous configurons la version (majeure et mineure) d'OpenGL, en 3.3 ici, puis nous indiquons à GLFW que nous utiliser la version "core" d'OpenGL (téléchargée plus haut via Glad).
                                En suite, <u>créeons notre contexte OpenGL</u>.
                                <div class="code_sample">
                                    // Création du contexte OpenGL</br>
                                    GLFWwindow* window = glfwCreateWindow(500, 500, "Mon programme OpenGL", NULL, NULL);</br>
                                    if (window == NULL) {</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; "Failed to create GLFW window" &lt;&lt; std::endl;</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glfwTerminate();</br>
                                    }</br>
                                    glfwMakeContextCurrent(window);
                                </div>
                                Ces fonctions restent aussi assez claires : "glfwCreateWindow()" crée la fenêtre pour OpenGL et la retourne sous forme de pointeur vers un objet <a href="https://www.glfw.org/docs/latest/group__window.html#ga3c96d80d363e67d13a41b5d1821f3242" target="_blank">"GLFWwindow"</a>, la condition vérifie si la création a bien eu lieu, et "glfwMakeContextCurrent()" indique à GLFW (et, indirectement, à l'OS du PC) que le contexte actuel du programme est le contexte passé en paramètre.
                                Nous pouvons constater la fonction "glfwTerminate()" dans la condition, qui a pour tâche de décharger GLFW pour le programme (si il doit s'arrêter).
                                Attardons nous sur <a href="https://www.glfw.org/docs/latest/group__window.html#ga3555a418df92ad53f917597fe2f64aeb" target="_blank">"glfwCreateWindow()"</a>.
                                Elle prend beaucoup de paramètres.
                                <u>Les deux premiers représentent la largeur et la hauteur de la fenêtre</u>.
                                Le troisième représente le titre affiché en haut à gauche de la fenêtre.
                                Le quatrième représente un pointeur vers un objet <a href="https://www.glfw.org/docs/latest/group__monitor.html#ga8d9efd1cde9426692c73fe40437d0ae3" target="_blank">GLFWmonitor</a>.
                                Si ce pointeur est utilisé, alors le programme va être en plein écran sur l'écran demandé.
                                Sinon (comme maintenant), il ne sera pas en plein écran.
                                Le cinquième permet de lier une autre fenêtre déjà crée avec celle-ci pour un partage de ressources entre fenêtre si besoin (nous n'en aurons pas besoin ici).
                                <span class="important">Si la fenêtre ne peut pas être générée, la fonction renvoie un pointeur nul, et la condition d'erreur est activée, affichant un mesage d'erreur et déchargeant GLFW</span>.
                                En suite, <u>chargeons Glad</u>.
                                <div class="code_sample">
                                    // Chargement de Glad</br>
                                    if (!gladLoadGLLoader((GLADloadproc)glfwGetProcAddress)) {</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;std::cout &lt;&lt; "Failed to initialize GLAD" &lt;&lt; std::endl;</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glfwTerminate();</br>
                                    }
                                </div>
                                <span class="important">Glad est chargé dans la fonction "gladLoadGLLoader()", qui renvoie "true" si le chargement est bon, ou "false" si il n'est pas bon</span>.
                                Si il ne l'est pas, la condition d'erreur est activée, affichant un mesage d'erreur et déchargeant GLFW.
                                Cette fonction est assez complexe : elle prend la fonction <a href="https://www.glfw.org/docs/latest/group__context.html#ga35f1837e6f666781842483937612f163" target="_blank">"glfwGetProcAddress()"</a> de GLFW en paramètre, retournant un pointeur vers la bonne API OpenGL utilisée par le contexte actuel.
                                N'hésitez pas à aller voir la documentation si cette fonction vous intéresse.
                                Dés que tout cela est fait, <span class="important">la partie configuration est terminée</span>.
                            </p>
                            <p>
                                Maintenant, <span class="important">nous allons implémenter la boucle qui va permettre à notre programme de tenir dans le temps</span>.
                                Tout aura lieu dans une boucle, qui s'arrêtera en même temps que le programme.
                                La boucle aura cette allure :
                                <div class="code_sample">
                                    // Boucle de temps</br>
                                    while(!glfwWindowShouldClose(window)) {</br></br>

                                    }</br>
                                    glfwTerminate();
                                </div>
                                Ici, <a href="https://www.glfw.org/docs/latest/group__context.html#ga35f1837e6f666781842483937612f163" target="_blank">"glfwWindowShouldClose()"</a> vérifiera si la fenêtre doit se fermer.
                                Après avoir fermer la fenêtre, on décharge GLFW avec "glfwTerminate()".
                                <u>Si nous lançons le programme comme ça, rien ne va se passer, et le programme ne pourra même pas se fermer tout seul</u>.
                                Pour utiliser la fenêtre, nous allons modifier l'intérieur de la boucle.
                                <div class="code_sample">
                                    // Boucle de temps</br>
                                    while(!glfwWindowShouldClose(window)) {</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;// Préparer l'affichage OpenGL</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glClearColor(0, 0.4, 0.9, 1.0);</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glClear(GL_COLOR_BUFFER_BIT);</br></br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;// Met à jour OpenGL</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glfwSwapBuffers(window);</br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;glfwPollEvents();</br>
                                    }</br>
                                    glfwTerminate();
                                </div>
                                Ce code rend la page tout à fait utilisable : décrivons le étape par étape.
                                <span class="important"><a href="https://registry.khronos.org/OpenGL-Refpages/gl4/html/glClear.xhtml" target="_blank">"glClear()"</a> permet de remettre les zones mémoires générées auparavant d'OpenGL à 0 (ou ne fait rien si aucune zone mémoire n'a été générée)</span>.
                                Comme ça, vous n'encombrez pas la mémoire de choses inutiles.
                                Ici, on passe en paramètre "GL_COLOR_BUFFER_BIT", pour n'effacer que la partie "couleur" d'OpenGL (l'ancienne zone d'affichage).
                                Il s'agit d'une fonction de base d'OpenGL (rendue utilisable par Glad).
                                Cependant, <u>OpenGL va remplir la nouvelle zone de mémoire d'affichage par une nouvelle couleur, spécifiée via la fonction <a href="https://registry.khronos.org/OpenGL-Refpages/gl4/html/glClearColor.xhtml" target="_blank">glClearColor()</a></u>.
                                Elle prend 4 paramètres : les valeurs RGBA de la couleur nécessaire (qui peuvent être des valeurs sur 255, ramenée à entre 0 et 1).
                                Ces valeurs doivent être entre 0 et 1.
                                Ici, il s'agit d'un bleu ciel (le même que la couleur d'arrière plan de la fenêtre nouvellement crée).
                                En suite, <span class="important">on demande à GLFW de confirmer l'affichage de la fenêtre, qui va être envoyée à la carte graphique avec <a href="https://www.glfw.org/docs/latest/group__window.html#ga15a5a1ee5b3c2ca6b15ca209a12efd14" target="_blank">glfwSwapBuffers()</a></span>.
                                Finalement, <u><a href="https://www.glfw.org/docs/latest/group__window.html#ga37bd57223967b4211d60ca1a0bf3c832" target="_blank">"glfwPollEvents()"</a> met à jour les évènements ayant eu lieu depuis le dernier appel de la fonction (clique de souris, entré clavier, fermeture de la fenêtre...)</u>.
                                Cet données seront par la suite accessible via des fonctions, que nous verrons plus tard.
                                <u>Maintenant que cette fenêtre est crée, commençons à la rendre utilisable</u>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer>
            <h1>Plus d'informations</h1>
            <div class="open-sans-regular">
                SAASF est proposé par l'organisation <a href="https://aster-system.github.io/aster-system/" target="_blank">Aster Système</a>.</br>
                Le site web est disponible sur Github, <a href="https://github.com/aster-system/saasf" target="_blank">dans ce repositorie</a>.</br>
                <span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">
                    <a property="dct:title" rel="cc:attributionURL" href="https://aster-system.github.io/saasf/">SAASF</a> par <span property="cc:attributionName">Aster Système</span> est proposé sous license <a href="https://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" alt=""><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" alt=""></a>
                </span>
            </div>
        </footer>
    </body>
</html>